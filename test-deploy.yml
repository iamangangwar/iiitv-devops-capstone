- hosts: test
  tasks:
  - name: Pull Docker Image
    docker_image:
      name: iamangangwar/iiitv-devops-capstone-test:latest
      state: present
      source: pull
  - name: Run Container
    block:
    - name: Run Container
      docker_container:
        name: website
        image: iamangangwar/iiitv-devops-capstone-test:latest
        state: started
        ports:
          - "80:80"
    rescue:
    - name: Remove Previous Container
      docker_container:
        name: website
        state: absent
    - name: Run Container
      docker_container:
        name: website
        image: iamangangwar/iiitv-devops-capstone-test:latest
        state: started
        ports:
          - "80:80"